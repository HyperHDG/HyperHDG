name: Doxygen

# Act only if a 'push' occurred.
on: push

# In that case do the job 'make_and_deploy_doxygen'
jobs:
  make_and_deploy_doxygen:
    name: Make and deploy doxygen
    runs-on: ubuntu-20.04
    steps:
    - name: Checkout current branch
      uses: actions/checkout@v2
      with:
        submodules: recursive
    - name: Conduct CMake test
      uses: HyperHDG/actions@doxygen
      with:
        deploy_doxygen: true
        doxygen_command: "make doxygen"
        ci_repo_token: ${{ secrets.CI_REPO_TOKEN }}
        ci_user_name: HyperHDG-CI
        ci_user_mail: HyperHDG@rupp.ink
        pages_repo_organization: HyperHDG
        pages_repo_name: auto_pages
        doxygen_path: doxygen/html
      # - name: Run deploy_doxygen script
      #   env:
      #     REPO_TOKEN: ${{ secrets.CI_REPO_TOKEN }}
      #   run: chmod 700 .ci/deploy_doxygen.sh; .ci/deploy_doxygen.sh
      #   shell: bash
      #   if: ${{ success() && github.ref == 'refs/heads/main' }}
